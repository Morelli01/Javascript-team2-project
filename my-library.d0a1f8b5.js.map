{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,aAGAC,SAASC,iBAAiB,oBAAoB,WAC5C,IAAMC,EAAOF,SAASG,cAAc,qBAC9BC,EAAiBJ,SAASG,cAAc,oBACxCE,EAAkBL,SAASG,cAAc,qBACzCG,EAAYN,SAASG,cAAc,eACnCI,EAAeP,SAASG,cAAc,kBACtCK,EAAiBR,SAASG,cAAc,oBAExCM,GADWT,SAASG,cAAc,aACrBH,SAASG,cAAc,iBAGtCO,GAFiBV,SAASG,cAAc,kBAE3B,IACXQ,EAAM,IAAI,EAAAC,EAAAC,SAgBhB,SAASC,EAAWC,GACdA,EAAKC,OAAS,GAChBd,EAAKe,UAAYC,mBAAmBH,GACpCR,EAAaY,UAAUC,IAAI,aAC3BZ,EAAeW,UAAUE,OAAO,eAEhCnB,EAAKe,UAAY,GACjBV,EAAaY,UAAUE,OAAO,aAC9Bb,EAAeW,UAAUC,IAAI,a,CAiDjC,SAASE,EAAeC,GACtB,IAAMC,EAAsBxB,SAASyB,eAAe,eAG9CC,EAAU,CACdH,aACAI,aAJmB,GAKnBC,aAAc,EACdC,aAAa,GAGI,IAAIC,EAAAhC,GAAJ,CAAe0B,EAAqBE,GAE5CK,GAAG,aAAa,SAAAC,GACzB,IACMC,EAba,IAYCD,EAAME,KACG,GACvBC,EAAMF,EAdO,GAgBnBtB,EAAIyB,gBACDC,MAAK,SAAAC,GAEJxB,EADkBwB,EAAIC,MAAMN,EAAOE,G,IAGpCK,OAAM,SAAAC,GACLC,QAAQC,IAAIF,E,OA/FpB9B,EAAIiC,sBACDP,MAAK,SAAAC,GAIJ,OAHAA,EAAIO,SAAQ,SAAAC,G,IAAGC,EAAED,EAAFC,GAAIC,EAAIF,EAAJE,KACjBtC,EAAWqC,GAAMC,C,IAEZrC,EAAIyB,e,IAEZC,MAAK,SAAAY,GACJnC,EAAWmC,GACX3B,EAAe2B,EAAejC,O,IAE/BwB,OAAM,SAAAC,GACLC,QAAQC,IAAIF,E,IAahBhC,EAAWU,UAAUC,IAAI,aAuBzBhB,EAAeH,iBAAiB,SAAS,WACvCI,EAAgBc,UAAU+B,OAAO,S,IAGnC5C,EAAUL,iBAAiB,SAAS,SAAA+B,GAClC,IAAMmB,EAAYnB,EAAMoB,OAAOC,QAAQC,MACvC,GAAkB,QAAdH,EACFxC,EAAIyB,gBAAgBC,MAAK,SAAAC,GACvBxB,EAAWwB,GACXhB,EAAegB,EAAItB,O,QAEhB,CACWuC,OAAOC,KAAK9C,GAAY+C,MACtC,SAAAC,G,OAAOhD,EAAWgD,KAASP,C,IAE7BxC,EAAIgD,mBAAmBR,GAAWd,MAAK,SAAAC,GACrCxB,EAAWwB,GACXhB,EAAegB,EAAItB,O,IAGvBX,EAAgBc,UAAUE,OAAO,S","sources":["src/javascript/librarymain.js"],"sourcesContent":["import Pagination from 'tui-pagination';\nimport { filmAPI } from '../javascript/mylibraryapi';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const ulEl = document.querySelector('.search_film_list');\n  const dropdownButton = document.querySelector('.dropdown-button');\n  const dropdownContent = document.querySelector('.dropdown-content');\n  const genreList = document.querySelector('.genre-list');\n  const errorSection = document.querySelector('.error-section');\n  const librarySection = document.querySelector('.library-section');\n  const dropdown = document.querySelector('.dropdown');\n  const librarybtn = document.querySelector('.librarybtnh');\n  const libraryvideo = document.querySelector('#trailer-video');\n\n  let categories = {};\n  const API = new filmAPI();\n\n  API.getCategoriesGenres()\n    .then(res => {\n      res.forEach(({ id, name }) => {\n        categories[id] = name;\n      });\n      return API.getCategories();\n    })\n    .then(categoriesData => {\n      markupFilm(categoriesData);\n      initPagination(categoriesData.length);\n    })\n    .catch(error => {\n      console.log(error);\n    });\n  function markupFilm(data) {\n    if (data.length > 0) {\n      ulEl.innerHTML = generateFilmMarkup(data);\n      errorSection.classList.add('is-hidden');\n      librarySection.classList.remove('is-hidden');\n    } else {\n      ulEl.innerHTML = '';\n      errorSection.classList.remove('is-hidden');\n      librarySection.classList.add('is-hidden');\n    }\n  }\n  librarybtn.classList.add('is-hidden');\n  function categoriesFilms(genreIds) {\n    let categoriesFilm = genreIds\n      .filter(genre => genre !== undefined)\n      .map(genre => categories[genre]);\n\n    if (categoriesFilm.length > 2) {\n      categoriesFilm = categoriesFilm.slice(0, 2);\n    }\n    if (categoriesFilm.length === 0) {\n      return 'Film';\n    }\n    return categoriesFilm.join(', ');\n  }\n\n  function yearsFilm(release_date, first_air_date) {\n    const year =\n      typeof release_date !== 'undefined'\n        ? release_date.split('-')[0]\n        : first_air_date.split('-')[0];\n    return year;\n  }\n\n  dropdownButton.addEventListener('click', () => {\n    dropdownContent.classList.toggle('active');\n  });\n\n  genreList.addEventListener('click', event => {\n    const genreName = event.target.dataset.genre;\n    if (genreName === 'All') {\n      API.getCategories().then(res => {\n        markupFilm(res);\n        initPagination(res.length);\n      });\n    } else {\n      const genreId = Object.keys(categories).find(\n        key => categories[key] === genreName\n      );\n      API.getCategoriesQuery(genreName).then(res => {\n        markupFilm(res);\n        initPagination(res.length);\n      });\n    }\n    dropdownContent.classList.remove('active');\n  });\n\n  function initPagination(totalItems) {\n    const paginationContainer = document.getElementById('pagination2');\n    const itemsPerPage = 12;\n\n    const options = {\n      totalItems,\n      itemsPerPage,\n      visiblePages: 5,\n      centerAlign: true,\n    };\n\n    const pagination = new Pagination(paginationContainer, options);\n\n    pagination.on('afterMove', event => {\n      const currentPage = event.page;\n      const start = (currentPage - 1) * itemsPerPage;\n      const end = start + itemsPerPage;\n\n      API.getCategories()\n        .then(res => {\n          const pageItems = res.slice(start, end);\n          markupFilm(pageItems);\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    });\n  }\n});\n"],"names":["$1VFfL","parcelRequire","document","addEventListener","ulEl","querySelector","dropdownButton","dropdownContent","genreList","errorSection","librarySection","librarybtn","categories","API","$j5MaG","filmAPI","markupFilm","data","length","innerHTML","generateFilmMarkup","classList","add","remove","initPagination","totalItems","paginationContainer","getElementById","options","itemsPerPage","visiblePages","centerAlign","$parcel$interopDefault","on","event","start","page","end","getCategories","then","res","slice","catch","error","console","log","getCategoriesGenres","forEach","param","id","name","categoriesData","toggle","genreName","target","dataset","genre","Object","keys","find","key","getCategoriesQuery"],"version":3,"file":"my-library.d0a1f8b5.js.map"}