{"mappings":"0YAAA,IAAAA,EAAAC,EAAA,S,aAGA,MAAMC,EAAe,WAERC,EAAcC,KAAKC,MAAMC,aAAaC,QAAQL,KAAkB,GAEtEM,eAAeC,EAAYC,GAChC,IAAIC,EAAS,KACb,MAAMC,EAAMF,EAAGG,OAAOC,QAAQ,sBAE9B,GAAIF,EAAK,CACP,MAAQG,GAAAC,GAAOJ,EAAIE,QAAQ,cAAcG,QAEzC,GADAN,QAyBJH,eAAwBE,GACtB,MAAMQ,QAAY,EAAAlB,EAAAmB,iBAAgBT,GAClC,OAAOQ,EAAIH,KAAOL,EAAKQ,EAAIH,GAAK,I,CA3BfK,CAASC,OAAOL,IAC3BL,EAAQ,CAEV,GADkBR,EAAYmB,MAAK,EAACP,GAAEA,KAASA,IAAOJ,IAEpDR,EAAYoB,OACVpB,EAAYqB,WAAUC,GAAQA,EAAKV,KAAOJ,IAC1C,GAEFL,aAAaoB,QAAQxB,EAAcE,KAAKuB,UAAUxB,IAClDS,EAAIgB,YAAc,oBACdC,OAAOC,SAASC,KAAKC,SAAS,qBAqB1BC,SAASC,eAAe,SAChCC,MAAMC,QAAU,OACtBH,SAASI,KAAKC,UAAUC,OAAO,aArBvB,EAAAC,EAAAC,YAAWtC,GAwBrB,WACE,GAA2B,IAAvBA,EAAYuC,OAAc,CAC5B,MAAMC,EAAeV,SAASW,cAAc,kBACrBX,SAASW,cAAc,oBAC/BN,UAAUO,IAAI,kBAC7BF,EAAaL,UAAUC,OAAO,iB,EA5BxBO,QAEG,CACL,MAAMrB,QAAa,EAAAzB,EAAAmB,iBAAgBR,GACnCR,EAAY4C,KAAKtB,GACjBnB,aAAaoB,QAAQxB,EAAcE,KAAKuB,UAAUxB,IAClDS,EAAIgB,YAAc,wB","sources":["src/javascript/local_storage.js"],"sourcesContent":["import { getCategoriesId } from './api';\nimport { markupFilm } from './favorite';\n\nconst KEY_FAVORITE = 'favorite';\n\nexport const favoriteArr = JSON.parse(localStorage.getItem(KEY_FAVORITE)) ?? [];\n\nexport async function onClickFilm(ev) {\n  let filmId = null;\n  const btn = ev.target.closest('.js_add_collection');\n\n  if (btn) {\n    const { id } = btn.closest('.js_add_id').dataset;\n    filmId = await findFilm(Number(id));\n    if (filmId) {\n      const inStorage = favoriteArr.some(({ id }) => id === filmId);\n      if (inStorage) {\n        favoriteArr.splice(\n          favoriteArr.findIndex(film => film.id === filmId),\n          1\n        );\n        localStorage.setItem(KEY_FAVORITE, JSON.stringify(favoriteArr));\n        btn.textContent = 'Add to my library';\n        if (window.location.href.includes('my-library.html')) {\n          colseModalLib();\n          markupFilm(favoriteArr);\n          chekMyLibraryFilms();\n        }\n      } else {\n        const film = await getCategoriesId(filmId);\n        favoriteArr.push(film);\n        localStorage.setItem(KEY_FAVORITE, JSON.stringify(favoriteArr));\n        btn.textContent = 'Remove from my library';\n      }\n    }\n  }\n}\n\nasync function findFilm(ev) {\n  const res = await getCategoriesId(ev);\n  return res.id === ev ? res.id : null;\n}\n\nfunction colseModalLib() {\n  const modal = document.getElementById('modal');\n  modal.style.display = 'none';\n  document.body.classList.remove('noScroll');\n}\n\nfunction chekMyLibraryFilms() {\n  if (favoriteArr.length === 0) {\n    const errorSectoin = document.querySelector('.error-section');\n    const librarySection = document.querySelector('.library-section');\n    librarySection.classList.add('display-hidden');\n    errorSectoin.classList.remove('display-hidden');\n  }\n}\n"],"names":["$dK6vY","parcelRequire","$bbb6a40c82964fbf$var$KEY_FAVORITE","$bbb6a40c82964fbf$export$f5cb82f0aad40ad6","JSON","parse","localStorage","getItem","async","$bbb6a40c82964fbf$export$f2eec75123b53c71","ev","filmId","btn","target","closest","id","id1","dataset","res","getCategoriesId","$bbb6a40c82964fbf$var$findFilm","Number","some","splice","findIndex","film","setItem","stringify","textContent","window","location","href","includes","document","getElementById","style","display","body","classList","remove","$ghKXP","markupFilm","length","errorSectoin","querySelector","add","$bbb6a40c82964fbf$var$chekMyLibraryFilms","push"],"version":3,"file":"hero.14d49e17.js.map"}