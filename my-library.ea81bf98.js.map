{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,aAGAC,SAASC,iBAAiB,oBAAoB,WAC5C,MAAMC,EAAOF,SAASG,cAAc,qBAC9BC,EAAiBJ,SAASG,cAAc,oBACxCE,EAAkBL,SAASG,cAAc,qBACzCG,EAAYN,SAASG,cAAc,eACnCI,EAAeP,SAASG,cAAc,kBACtCK,EAAiBR,SAASG,cAAc,oBAC7BH,SAASG,cAAc,aAExC,IAAIM,EAAa,GACjB,MAAMC,EAAM,IAAI,EAAAC,EAAAC,SAiBhB,SAASC,EAAWC,GACdA,EAAKC,OAAS,GAChBb,EAAKc,UAAYC,mBAAmBH,GACpCP,EAAaW,UAAUC,IAAI,aAC3BX,EAAeU,UAAUE,OAAO,eAEhClB,EAAKc,UAAY,GACjBT,EAAaW,UAAUE,OAAO,aAC9BZ,EAAeU,UAAUC,IAAI,a,CAiDjC,SAASE,EAAeC,GACtB,MAAMC,EAAsBvB,SAASwB,eAAe,eAG9CC,EAAU,C,WACdH,E,aAHmB,GAKnBI,aAAc,EACdC,aAAa,GAGI,IAAIC,EAAA9B,GAAJ,CAAeyB,EAAqBE,GAE5CI,GAAG,aAAaC,IACzB,MACMC,EAba,IAYCD,EAAME,KACG,GACvBC,EAAMF,EAdO,GAgBnBrB,EAAIwB,gBACDC,MAAKC,IAEJvB,EADkBuB,EAAIC,MAAMN,EAAOE,GACd,IAEtBK,OAAMC,IACLC,QAAQC,IAAIF,EAAM,GAClB,G,CAjGR7B,EAAIgC,sBACDP,MAAKC,IACJA,EAAIO,SAAQ,EAACC,GAAEA,EAAEC,KAAEA,MACjBpC,EAAWmC,GAAMC,CAAI,IAEhBnC,EAAIwB,mBAEZC,MAAKW,IACJjC,EAAWiC,GACXzB,EAAeyB,EAAe/B,OAAO,IAEtCuB,OAAMC,IACLC,QAAQC,IAAIF,EAAM,IAqCtBnC,EAAeH,iBAAiB,SAAS,KACvCI,EAAgBa,UAAU6B,OAAO,SAAS,IAG5CzC,EAAUL,iBAAiB,SAAS6B,IAClC,MAAMkB,EAAYlB,EAAMmB,OAAOC,QAAQC,MACvC,GAAkB,QAAdH,EACFtC,EAAIwB,gBAAgBC,MAAKC,IACvBvB,EAAWuB,GACXf,EAAee,EAAIrB,OAAO,QAEvB,CACWqC,OAAOC,KAAK5C,GAAY6C,MACtCC,GAAO9C,EAAW8C,KAASP,IAE7BtC,EAAI8C,mBAAmBR,GAAWb,MAAKC,IACrCvB,EAAWuB,GACXf,EAAee,EAAIrB,OAAO,G,CAG9BV,EAAgBa,UAAUE,OAAO,SAAS,G","sources":["src/javascript/librarymain.js"],"sourcesContent":["import Pagination from 'tui-pagination';\nimport { filmAPI } from '../javascript/mylibraryapi';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const ulEl = document.querySelector('.search_film_list');\n  const dropdownButton = document.querySelector('.dropdown-button');\n  const dropdownContent = document.querySelector('.dropdown-content');\n  const genreList = document.querySelector('.genre-list');\n  const errorSection = document.querySelector('.error-section');\n  const librarySection = document.querySelector('.library-section');\n  const dropdown = document.querySelector('.dropdown');\n\n  let categories = {};\n  const API = new filmAPI();\n\n  API.getCategoriesGenres()\n    .then(res => {\n      res.forEach(({ id, name }) => {\n        categories[id] = name;\n      });\n      return API.getCategories();\n    })\n    .then(categoriesData => {\n      markupFilm(categoriesData);\n      initPagination(categoriesData.length);\n    })\n    .catch(error => {\n      console.log(error);\n    });\n\n  function markupFilm(data) {\n    if (data.length > 0) {\n      ulEl.innerHTML = generateFilmMarkup(data);\n      errorSection.classList.add('is-hidden');\n      librarySection.classList.remove('is-hidden');\n    } else {\n      ulEl.innerHTML = '';\n      errorSection.classList.remove('is-hidden');\n      librarySection.classList.add('is-hidden');\n    }\n  }\n\n  function categoriesFilms(genreIds) {\n    let categoriesFilm = genreIds\n      .filter(genre => genre !== undefined)\n      .map(genre => categories[genre]);\n\n    if (categoriesFilm.length > 2) {\n      categoriesFilm = categoriesFilm.slice(0, 2);\n    }\n    if (categoriesFilm.length === 0) {\n      return 'Film';\n    }\n    return categoriesFilm.join(', ');\n  }\n\n  function yearsFilm(release_date, first_air_date) {\n    const year =\n      typeof release_date !== 'undefined'\n        ? release_date.split('-')[0]\n        : first_air_date.split('-')[0];\n    return year;\n  }\n\n  dropdownButton.addEventListener('click', () => {\n    dropdownContent.classList.toggle('active');\n  });\n\n  genreList.addEventListener('click', event => {\n    const genreName = event.target.dataset.genre;\n    if (genreName === 'All') {\n      API.getCategories().then(res => {\n        markupFilm(res);\n        initPagination(res.length);\n      });\n    } else {\n      const genreId = Object.keys(categories).find(\n        key => categories[key] === genreName\n      );\n      API.getCategoriesQuery(genreName).then(res => {\n        markupFilm(res);\n        initPagination(res.length);\n      });\n    }\n    dropdownContent.classList.remove('active');\n  });\n\n  function initPagination(totalItems) {\n    const paginationContainer = document.getElementById('pagination2');\n    const itemsPerPage = 12;\n\n    const options = {\n      totalItems,\n      itemsPerPage,\n      visiblePages: 5,\n      centerAlign: true,\n    };\n\n    const pagination = new Pagination(paginationContainer, options);\n\n    pagination.on('afterMove', event => {\n      const currentPage = event.page;\n      const start = (currentPage - 1) * itemsPerPage;\n      const end = start + itemsPerPage;\n\n      API.getCategories()\n        .then(res => {\n          const pageItems = res.slice(start, end);\n          markupFilm(pageItems);\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    });\n  }\n});\n"],"names":["$fb9GJ","parcelRequire","document","addEventListener","ulEl","querySelector","dropdownButton","dropdownContent","genreList","errorSection","librarySection","categories","API","$i0Y6p","filmAPI","markupFilm","data","length","innerHTML","generateFilmMarkup","classList","add","remove","initPagination","totalItems","paginationContainer","getElementById","options","visiblePages","centerAlign","$parcel$interopDefault","on","event","start","page","end","getCategories","then","res","slice","catch","error","console","log","getCategoriesGenres","forEach","id","name","categoriesData","toggle","genreName","target","dataset","genre","Object","keys","find","key","getCategoriesQuery"],"version":3,"file":"my-library.ea81bf98.js.map"}