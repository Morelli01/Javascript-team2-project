{"mappings":"ucAAA,IAK2BA,EAL3BC,EAAAC,EAAA,S,uCAGMC,EAAe,WAERC,EAA4D,QAA9CJ,EAAAK,KAAKC,MAAMC,aAAaC,QAAQL,WAAc,IAA9CH,IAAkD,G,SAEvDS,EAAYC,G,OAAZC,EAAWC,MAAAC,KAAAC,U,UAAXH,I,OAAAA,EAAfI,EAAAd,EAAA,CAAAc,EAAAC,GAAAC,MAAA,SAAAC,EAA2BR,G,IAC5BS,EACEC,EAGIC,EAiBEC,E,qEArBRH,EAAS,OACPC,EAAMV,EAAGa,OAAOC,QAAQ,uBAEvB,C,uBACCH,EAASD,EAAII,QAAQ,cAAcC,QAAjCC,G,SACOC,EAASC,OAAOP,I,YAA/BF,EAAMU,EAAAC,MACI,C,oBACU1B,EAAY2B,MAAK,SAAAC,G,OAAKA,EAAFN,KAAgBP,C,IACzC,C,gBACXf,EAAY6B,OACV7B,EAAY8B,WAAU,SAAAC,G,OAAQA,EAAKT,KAAOP,C,IAC1C,GAEFZ,aAAa6B,QAAQjC,EAAcE,KAAKgC,UAAUjC,IAClDgB,EAAIkB,YAAc,oBACdC,OAAOC,SAASC,KAAKC,SAAS,qBAChCC,KACA,EAAAC,EAAAC,YAAWzC,GACX0C,K,0CAGiB,EAAAC,EAAAC,iBAAgB7B,G,QAA7BG,EAAIO,EAAAC,KACV1B,EAAY6C,KAAK3B,GACjBf,aAAa6B,QAAQjC,EAAcE,KAAKgC,UAAUjC,IAClDgB,EAAIkB,YAAc,yB,6CAzBO1B,MAAAC,KAAAC,U,UA+BlBa,EAASjB,G,OAATwC,EAAQtC,MAAAC,KAAAC,U,UAARoC,I,OAAAA,EAAfnC,EAAAd,EAAA,CAAAc,EAAAC,GAAAC,MAAA,SAAAC,EAAwBR,G,IAChByC,E,mFAAY,EAAAJ,EAAAC,iBAAgBtC,G,cAA5ByC,EAAGtB,EAAAC,K,kBACFqB,EAAIzB,KAAOhB,EAAKyC,EAAIzB,GAAK,M,4CAFXd,MAAAC,KAAAC,U,CAKvB,SAAS6B,IACOS,SAASC,eAAe,SAChCC,MAAMC,QAAU,OACtBH,SAASI,KAAKC,UAAUC,OAAO,W,CAGjC,SAASZ,IACP,GAA2B,IAAvB1C,EAAYuD,OAAc,CAC5B,IAAMC,EAAeR,SAASS,cAAc,kBACrBT,SAASS,cAAc,oBAC/BJ,UAAUK,IAAI,kBAC7BF,EAAaH,UAAUC,OAAO,iB","sources":["src/javascript/local_storage.js"],"sourcesContent":["import { getCategoriesId } from './api';\nimport { markupFilm } from './favorite';\n\nconst KEY_FAVORITE = 'favorite';\n\nexport const favoriteArr = JSON.parse(localStorage.getItem(KEY_FAVORITE)) ?? [];\n\nexport async function onClickFilm(ev) {\n  let filmId = null;\n  const btn = ev.target.closest('.js_add_collection');\n\n  if (btn) {\n    const { id } = btn.closest('.js_add_id').dataset;\n    filmId = await findFilm(Number(id));\n    if (filmId) {\n      const inStorage = favoriteArr.some(({ id }) => id === filmId);\n      if (inStorage) {\n        favoriteArr.splice(\n          favoriteArr.findIndex(film => film.id === filmId),\n          1\n        );\n        localStorage.setItem(KEY_FAVORITE, JSON.stringify(favoriteArr));\n        btn.textContent = 'Add to my library';\n        if (window.location.href.includes('my-library.html')) {\n          colseModalLib();\n          markupFilm(favoriteArr);\n          chekMyLibraryFilms();\n        }\n      } else {\n        const film = await getCategoriesId(filmId);\n        favoriteArr.push(film);\n        localStorage.setItem(KEY_FAVORITE, JSON.stringify(favoriteArr));\n        btn.textContent = 'Remove from my library';\n      }\n    }\n  }\n}\n\nasync function findFilm(ev) {\n  const res = await getCategoriesId(ev);\n  return res.id === ev ? res.id : null;\n}\n\nfunction colseModalLib() {\n  const modal = document.getElementById('modal');\n  modal.style.display = 'none';\n  document.body.classList.remove('noScroll');\n}\n\nfunction chekMyLibraryFilms() {\n  if (favoriteArr.length === 0) {\n    const errorSectoin = document.querySelector('.error-section');\n    const librarySection = document.querySelector('.library-section');\n    librarySection.classList.add('display-hidden');\n    errorSectoin.classList.remove('display-hidden');\n  }\n}\n"],"names":["$94c004c7183ad428$var$ref","$bpxeT","parcelRequire","$94c004c7183ad428$var$KEY_FAVORITE","$94c004c7183ad428$export$f5cb82f0aad40ad6","JSON","parse","localStorage","getItem","$94c004c7183ad428$export$f2eec75123b53c71","ev","$94c004c7183ad428$var$_onClickFilm","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","filmId","btn","id1","film1","target","closest","dataset","id","$94c004c7183ad428$var$findFilm","Number","_ctx","sent","some","param","splice","findIndex","film","setItem","stringify","textContent","window","location","href","includes","$94c004c7183ad428$var$colseModalLib","$d5bOi","markupFilm","$94c004c7183ad428$var$chekMyLibraryFilms","$8LhE9","getCategoriesId","push","$94c004c7183ad428$var$_findFilm","res","document","getElementById","style","display","body","classList","remove","length","errorSectoin","querySelector","add"],"version":3,"file":"hero.2a48141d.js.map"}