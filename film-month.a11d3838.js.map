{"mappings":"sSAAA,IAAAA,EAAAC,EAAA,S,uCAKA,IAAIC,EAAc,KAEjB,WACC,MAAMC,EAAmBC,SAASC,cAAc,uBAChD,IAAKF,EAAkB,QAEvB,EAAAG,EAAAC,gBACA,MAAMC,QAAa,EAAAR,EAAAS,wBACnBP,EAAcM,EACdE,QAAQC,IAAI,YAAaH,GAEzB,MAAMI,QAAe,EAAAZ,EAAAa,aAIjBV,IACFA,EAAiBW,UAAYC,EAAaP,EAAMI,IAGhCR,SAASC,cAAc,0BAC/BW,iBAAiB,SAASC,MAAOC,IACzC,MAAMC,EAAe,IAAI,EAAAC,EAAAC,cACnBC,EAAcH,EAAaI,gBAAgBL,EAAMM,OAAOC,QAAQC,IAChEC,EAASvB,SAASC,cAAc,0BAClCiB,GACFZ,QAAQC,IAAI,YACZQ,EAAaS,sBAAsB1B,KAEnCQ,QAAQC,IAAI,UACZQ,EAAaU,iBAAiB3B,IAEhCyB,EAAOG,YAAcR,EACjB,sBACA,0BAA0B,KAEhC,EAAAhB,EAAAyB,cACD,EAlCA,GAoCD,MAAMhB,EAAe,CAACP,EAAMI,KAC1B,MAGMoB,GAHUC,OAAOC,YAAc,IACjC,kDACA,oDACuB1B,EAAK2B,YAC1BC,EAAW5B,EAAK4B,SAChBC,EAAQ7B,EAAK8B,eAGbC,EAAc,IAAIC,KAAKhC,EAAKiC,cAK5BC,EAAuB,GAJjBH,EAAYI,UAAUC,WAAWC,SAAS,EAAG,SAC1CN,EAAYO,WAAa,GAAGF,WAAWC,SAAS,EAAG,QACrDN,EAAYQ,gBAKnBzB,GADe,IAAI,EAAAF,EAAAC,eACQE,gBAAgBf,EAAKkB,IAEhDsB,EAAcxC,EAAKyC,aACnBC,EAAY1C,EAAK2C,WACjBC,EAAa5C,EAAK4C,WAClBC,EAAazC,EAChB0C,QAAQC,GAAU/C,EAAKgD,UAAUC,MAAM,EAAG,GAAGC,SAASH,EAAM7B,MAC5DiC,KAAI,EAACC,KAAEA,KAAWA,IAClBC,KAAK,MACR,MAAO,oFAEkC7B,gIAIGK,0PAKyBK,2OAK5BM,6GAEAE,iOAKkB,EAAAY,EAAAC,OAAMX,EAAY,wMAIlBC,kMAKTjB,mIAGc5B,EAAKkB,mBAC3DJ,EAAc,sBAAwB,4EAI/C,C,sCC7GH,SAAS0C,EAAMC,EAAQC,GACrB,OAAOC,KAAKJ,MAAME,EAASC,GAAUA,C,qJAGvC,MAAME,EAAkB,CAACC,EAAKC,IACrBH,KAAKI,MAAMJ,KAAKK,UAAYF,EAAMD,EAAM,IAAMA,EAGvD,SAASI,EAAYC,EAASC,GAC5B,OAAQD,EAAQ5D,UAAY,kDAExB6D,EAAS,0CAC8BR,KAAKJ,MAC9CY,EAAS,wB,0FCbN,MAAMC,EACXC,cACEC,KAAKC,QAAU,GACfD,KAAKE,6B,CAGPA,8BACE,MAAMC,EAAcC,aAAaC,QAAQ,aACzCL,KAAKC,QAAUE,EAAcG,KAAKC,MAAMJ,GAAe,E,CAGzDK,4BACEJ,aAAaK,QAAQ,YAAaH,KAAKI,UAAUV,KAAKC,S,CAGxDxD,gBAAgBG,GACd,OAAOoD,KAAKC,QAAQU,MAAMC,GAAgBA,EAAYhE,IAAMA,G,CAG9DG,iBAAiBrB,GACfsE,KAAKC,QAAQY,KAAKnF,GAClBsE,KAAKQ,2B,CAGP1D,sBAAsBpB,GACpB,MAAMoF,EAAQd,KAAKC,QAAQc,WAAWH,GAAgBA,EAAYhE,KAAOlB,EAAKkB,MAChE,IAAVkE,IACFd,KAAKC,QAAQe,OAAOF,EAAO,GAC3Bd,KAAKQ,4B","sources":["src/javascript/film-month.js","src/javascript/utils.js","src/javascript/movie-library.js"],"sourcesContent":["import { getGenres, getRandomFilmOfMonth } from './api';\nimport { spinnerStart, spinnerStop } from './spin';\nimport { round } from './utils';\nimport { MovieLibrary } from './movie-library';\n\nlet currentFilm = null;\n\n(async () => {\n  const filmMonthWrapper = document.querySelector('.film-month_wrapper');\n  if (!filmMonthWrapper) return;\n\n  spinnerStart();\n  const film = await getRandomFilmOfMonth();\n  currentFilm = film;\n  console.log('filmMonth', film);\n\n  const genres = await getGenres();\n  // spinnerStop()\n\n\n  if (filmMonthWrapper) {\n    filmMonthWrapper.innerHTML = createMarkup(film, genres);\n  }\n\n  const addButton = document.querySelector('.film-month_button-add');\n  addButton.addEventListener('click', async (event) => {\n    const movieLibrary = new MovieLibrary()\n    const isInLibrary = movieLibrary.isFilmInLibrary(event.target.dataset.id);\n    const button = document.querySelector('.film-month_button-add');\n    if (isInLibrary) {\n      console.log('removing');\n      movieLibrary.removeFilmFromLibrary(currentFilm);\n    } else {\n      console.log('adding');\n      movieLibrary.addFilmToLibrary(currentFilm);\n    }\n    button.textContent = isInLibrary\n      ? 'Add film to library'\n      : 'Remove film from library';\n  });\n  spinnerStop();\n})();\n\nconst createMarkup = (film, genres) => {\n  const baseUrl = window.innerWidth <= 600\n    ? 'https://image.tmdb.org/t/p/w600_and_h900_bestv2'\n    : 'https://image.tmdb.org/t/p/w1066_and_h600_bestv2';\n  const imageSrc = baseUrl + film.poster_path;\n  const overview = film.overview;\n  const title = film.original_title;\n\n\n  const releaseDate = new Date(film.release_date);\n  const day = releaseDate.getDate().toString().padStart(2, '0');\n  const month = (releaseDate.getMonth() + 1).toString().padStart(2, '0');\n  const year = releaseDate.getFullYear();\n\n  const formattedReleaseDate = `${day}.${month}.${year}`;\n\n  const movieLibrary = new MovieLibrary()\n  const isInLibrary = movieLibrary.isFilmInLibrary(film.id);\n\n  const voteAverage = film.vote_average;\n  const voteCount = film.vote_count;\n  const popularity = film.popularity;\n  const filmGenres = genres\n    .filter((genre) => film.genre_ids.slice(0, 2).includes(genre.id))\n    .map(({ name }) => name)\n    .join(', ');\n  return `\n      <div class='film-month_image'>\n        <img class='film-month_img' src='${imageSrc}' alt=''>\n      </div>\n      <div class='film-month_content'>\n        <div>\n          <h3 class='film-month_info-title'>${title}</h3>\n        </div>\n        <div class='film-month_info'>\n          <div class='film-month_info-item'>\n            <span class='film-month_info-label'>Release date</span>\n            <span class='film-month_info-value film-month_info-year'>${formattedReleaseDate}</span>\n          </div>\n          <div class='film-month_info-item'>\n            <span class='film-month_info-label'>Vote/Votes</span>\n            <span class='film-month_info-value'>\n              <span class='value-number'>${voteAverage}</span>\n               <span class='value-separator'>/</span>\n              <span class='value-number'>${voteCount}</span>\n            </span>\n          </div>\n          <div class='film-month_info-item'>\n            <span class='film-month_info-label'>Popularity</span>\n            <span class='film-month_info-value span-value'>${round(popularity, 10)}</span>\n          </div>\n          <div class='film-month_info-item'>\n            <span class='film-month_info-label'>Genre</span>\n            <span class='film-month_info-value span-value'>${filmGenres}</span>\n          </div>\n        </div>\n        <div class='film-month_about'>\n          <h4 class='film-month_about-title'>About</h4>\n          <p class='film-month_about-description'>${overview}</p>\n        </div>\n        <div class='film-month_button'>\n          <button class='button film-month_button-add' data-id='${film.id}'>\n          ${isInLibrary ? 'Remove from library' : 'Add to my library'}\n          </button>\n        </div>\n      </div>\n  `;\n};\n\n","function round(number, digits) {\n  return Math.round(number * digits) / digits;\n}\n\nconst getRandomNumber = (min, max) => {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\nfunction renderStars(element, rating) {\n  return (element.innerHTML = `\n    <div class=\"film_rating\" style=\"--rating:${\n      rating / 2\n    };\" aria-label=\"Rating of this film is ${Math.round(\n    rating / 2\n  )} out of 5.\"></div>\n`);\n}\n\nexport { round, getRandomNumber, renderStars };\n","export class MovieLibrary {\n  constructor() {\n    this.library = [];\n    this.loadLibraryFromLocalStorage();\n  }\n\n  loadLibraryFromLocalStorage() {\n    const libraryJSON = localStorage.getItem('myLibrary');\n    this.library = libraryJSON ? JSON.parse(libraryJSON) : [];\n  }\n\n  saveLibraryToLocalStorage() {\n    localStorage.setItem('myLibrary', JSON.stringify(this.library));\n  }\n\n  isFilmInLibrary(id) {\n    return this.library.some((libraryFilm) => libraryFilm.id == id);\n  }\n\n  addFilmToLibrary(film) {\n    this.library.push(film);\n    this.saveLibraryToLocalStorage();\n  }\n\n  removeFilmFromLibrary(film) {\n    const index = this.library.findIndex((libraryFilm) => libraryFilm.id === film.id);\n    if (index !== -1) {\n      this.library.splice(index, 1);\n      this.saveLibraryToLocalStorage();\n    }\n  }\n}\n"],"names":["$dK6vY","parcelRequire","$504f2e7c7c3fccdf$var$currentFilm","filmMonthWrapper","document","querySelector","$dpMC2","spinnerStart","film","getRandomFilmOfMonth","console","log","genres","getGenres","innerHTML","$504f2e7c7c3fccdf$var$createMarkup","addEventListener","async","event","movieLibrary","$h3giK","MovieLibrary","isInLibrary","isFilmInLibrary","target","dataset","id","button","removeFilmFromLibrary","addFilmToLibrary","textContent","spinnerStop","imageSrc","window","innerWidth","poster_path","overview","title","original_title","releaseDate","Date","release_date","formattedReleaseDate","getDate","toString","padStart","getMonth","getFullYear","voteAverage","vote_average","voteCount","vote_count","popularity","filmGenres","filter","genre","genre_ids","slice","includes","map","name","join","$9Wu9X","round","$73d0ece61bfba828$export$2077e0241d6afd3c","number","digits","Math","$73d0ece61bfba828$export$eab19c48dcb6310d","min","max","floor","random","$73d0ece61bfba828$export$6b958f153b36132a","element","rating","$c69f5c99a1f5378f$export$a77202e529bf9901","constructor","this","library","loadLibraryFromLocalStorage","libraryJSON","localStorage","getItem","JSON","parse","saveLibraryToLocalStorage","setItem","stringify","some","libraryFilm","push","index","findIndex","splice"],"version":3,"file":"film-month.a11d3838.js.map"}